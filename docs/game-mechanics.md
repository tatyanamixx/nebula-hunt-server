# –ò–≥—Ä–æ–≤–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞

## –û–±–∑–æ—Ä

Nebulahunt - —ç—Ç–æ –∫–æ—Å–º–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è —Å —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ idle-–≥–µ–π–º–ø–ª–µ—è, –≥–¥–µ –∏–≥—Ä–æ–∫–∏ —É–ø—Ä–∞–≤–ª—è—é—Ç –≥–∞–ª–∞–∫—Ç–∏–∫–∞–º–∏, —Ä–∞–∑–≤–∏–≤–∞—é—Ç —ç–∫–æ–Ω–æ–º–∏–∫—É, –≤—ã–ø–æ–ª–Ω—è—é—Ç –∑–∞–¥–∞—á–∏ –∏ —É—á–∞—Å—Ç–≤—É—é—Ç –≤ —Å–æ–±—ã—Ç–∏—è—Ö. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–ø–∏—Å—ã–≤–∞–µ—Ç –≤—Å–µ –∏–≥—Ä–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã –∏ –º–µ—Ö–∞–Ω–∏–∫–∏.

## –û—Å–Ω–æ–≤–Ω—ã–µ –∏–≥—Ä–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã

### 1. –≠–∫–æ–Ω–æ–º–∏–∫–∞

#### –†–µ—Å—É—Ä—Å—ã

**–ó–≤–µ–∑–¥—ã (Stars)**

-   –û—Å–Ω–æ–≤–Ω–æ–π —Ä–µ—Å—É—Ä—Å –∏–≥—Ä—ã
-   –ü—Ä–æ–∏–∑–≤–æ–¥—è—Ç—Å—è –≥–∞–ª–∞–∫—Ç–∏–∫–∞–º–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
-   –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –ø–æ–∫—É–ø–∫–∏ –≥–∞–ª–∞–∫—Ç–∏–∫ –∏ –∞–ø–≥—Ä–µ–π–¥–æ–≤
-   –§–æ—Ä–º—É–ª–∞ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞: `–±–∞–∑–æ–≤–∞—è_–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å * –º–Ω–æ–∂–∏—Ç–µ–ª–∏ * –≤—Ä–µ–º—è`

**–ó–≤–µ–∑–¥–Ω–∞—è –ø—ã–ª—å (Stardust)**

-   –í—Ç–æ—Ä–∏—á–Ω—ã–π —Ä–µ—Å—É—Ä—Å
-   –ü–æ–ª—É—á–∞–µ—Ç—Å—è –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∑–∞–¥–∞—á –∏ —Å–æ–±—ã—Ç–∏–π
-   –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–∫—É–ø–∫–∏ –∞–ø–≥—Ä–µ–π–¥–æ–≤
-   –§–æ—Ä–º—É–ª–∞ –ø–æ–ª—É—á–µ–Ω–∏—è: `–±–∞–∑–æ–≤–∞—è_–Ω–∞–≥—Ä–∞–¥–∞ * –º–Ω–æ–∂–∏—Ç–µ–ª–∏ * –±–æ–Ω—É—Å—ã`

**–¢–µ–º–Ω–∞—è –º–∞—Ç–µ—Ä–∏—è (Dark Matter)**

-   –ü—Ä–µ–º–∏—É–º —Ä–µ—Å—É—Ä—Å
-   –†–µ–¥–∫–∏–π —Ä–µ—Å—É—Ä—Å –¥–ª—è –æ—Å–æ–±—ã—Ö –∞–ø–≥—Ä–µ–π–¥–æ–≤
-   –ü–æ–ª—É—á–∞–µ—Ç—Å—è –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–¥–∞—á
-   –§–æ—Ä–º—É–ª–∞ –ø–æ–ª—É—á–µ–Ω–∏—è: `—Å–ª–æ–∂–Ω–æ—Å—Ç—å_–∑–∞–¥–∞—á–∏ * —Å–ª—É—á–∞–π–Ω—ã–π_–º–Ω–æ–∂–∏—Ç–µ–ª—å`

#### –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ

```javascript
// –§–æ—Ä–º—É–ª–∞ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ –∑–≤–µ–∑–¥
function calculateStarProduction(galaxies, multipliers) {
	let totalProduction = 0;

	galaxies.forEach((galaxy) => {
		const baseProduction = galaxy.starCurrent * 0.1; // 10% –æ—Ç —Ç–µ–∫—É—â–∏—Ö –∑–≤–µ–∑–¥
		const productionMultiplier = multipliers.production || 1.0;
		const galaxyEfficiency = galaxy.galaxyProperties.efficiency || 1.0;

		totalProduction +=
			baseProduction * productionMultiplier * galaxyEfficiency;
	});

	return totalProduction;
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
setInterval(() => {
	const production = calculateStarProduction(userGalaxies, userMultipliers);
	userState.state.totalStars += production;
}, 1000);
```

### 2. –ì–∞–ª–∞–∫—Ç–∏–∫–∏

#### –¢–∏–ø—ã –≥–∞–ª–∞–∫—Ç–∏–∫

**–°–ø–∏—Ä–∞–ª—å–Ω–∞—è (Spiral)**

-   –ë–∞–∑–æ–≤–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 100 –∑–≤–µ–∑–¥/—Å–µ–∫
-   –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: 1.0
-   –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏: —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ

**–≠–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–∞—è (Elliptical)**

-   –ë–∞–∑–æ–≤–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 150 –∑–≤–µ–∑–¥/—Å–µ–∫
-   –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: 0.8
-   –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏: –≤—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –Ω–∏–∑–∫–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å

**–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è (Irregular)**

-   –ë–∞–∑–æ–≤–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 80 –∑–≤–µ–∑–¥/—Å–µ–∫
-   –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: 1.2
-   –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏: –≤—ã—Å–æ–∫–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å, –Ω–∏–∑–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

#### –°–≤–æ–π—Å—Ç–≤–∞ –≥–∞–ª–∞–∫—Ç–∏–∫

```javascript
const galaxyProperties = {
	type: 'spiral', // spiral, elliptical, irregular
	color: 'blue', // blue, red, green, yellow, purple
	size: 'medium', // small, medium, large
	features: {
		blackHole: true, // —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –Ω–∞ 50%
		nebula: false, // —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –Ω–∞ 30%
		asteroidBelt: true, // —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –Ω–∞ 20%
	},
	coordinates: {
		x: 100,
		y: 200,
		z: 50,
	},
	efficiency: 1.0, // –º–Ω–æ–∂–∏—Ç–µ–ª—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
	stability: 0.8, // —É—Ä–æ–≤–µ–Ω—å —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
};
```

#### –°–æ–∑–¥–∞–Ω–∏–µ –≥–∞–ª–∞–∫—Ç–∏–∫–∏

```javascript
function createGalaxy(userId, galaxyData) {
	const galaxy = {
		userId: userId,
		starMin: galaxyData.starMin || 100,
		starCurrent: galaxyData.starCurrent || 100,
		price: calculateGalaxyPrice(galaxyData),
		seed: generateUniqueSeed(),
		particleCount: galaxyData.particleCount || 100,
		galaxyProperties: generateGalaxyProperties(galaxyData.seed),
		active: true,
	};

	return galaxy;
}

function calculateGalaxyPrice(galaxyData) {
	const basePrice = 100;
	const sizeMultiplier = {
		small: 0.5,
		medium: 1.0,
		large: 2.0,
	};

	return basePrice * sizeMultiplier[galaxyData.size || 'medium'];
}
```

### 3. –°–∏—Å—Ç–µ–º–∞ –∞–ø–≥—Ä–µ–π–¥–æ–≤

#### –î–µ—Ä–µ–≤–æ –∞–ø–≥—Ä–µ–π–¥–æ–≤

```javascript
const upgradeTree = {
	nodes: {
		star_production_1: {
			id: 'star_production_1',
			name: 'Star Production I',
			description: {
				en: 'Increase star production by 10%',
				ru: '–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –∑–≤–µ–∑–¥ –Ω–∞ 10%',
			},
			maxLevel: 10,
			basePrice: 100,
			effectPerLevel: 0.1,
			category: 'production',
			children: ['star_production_2', 'efficiency_1'],
			requirements: { minStars: 100 },
		},
		efficiency_1: {
			id: 'efficiency_1',
			name: 'Efficiency I',
			description: {
				en: 'Increase galaxy efficiency by 5%',
				ru: '–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≥–∞–ª–∞–∫—Ç–∏–∫ –Ω–∞ 5%',
			},
			maxLevel: 5,
			basePrice: 150,
			effectPerLevel: 0.05,
			category: 'economy',
			children: ['efficiency_2'],
			requirements: {
				minStars: 200,
				requiredUpgrades: ['star_production_1'],
			},
		},
	},
	connections: [
		{ from: 'star_production_1', to: 'star_production_2' },
		{ from: 'star_production_1', to: 'efficiency_1' },
		{ from: 'efficiency_1', to: 'efficiency_2' },
	],
};
```

#### –ü–æ–∫—É–ø–∫–∞ –∞–ø–≥—Ä–µ–π–¥–∞

```javascript
function purchaseUpgrade(userId, upgradeId, level) {
	const upgrade = upgradeTree.nodes[upgradeId];
	const userState = getUserState(userId);

	// –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
	if (!isUpgradeAvailable(userId, upgradeId)) {
		throw new Error('Upgrade not available');
	}

	// –†–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏
	const cost = calculateUpgradeCost(upgrade, level);

	// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤
	if (userState.state.stardustCount < cost) {
		throw new Error('Insufficient resources');
	}

	// –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤
	applyUpgradeEffects(userId, upgradeId, level);

	// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
	updateUpgradeProgress(userId, upgradeId, level);

	// –ê–∫—Ç–∏–≤–∞—Ü–∏—è –Ω–æ–≤—ã—Ö —É–∑–ª–æ–≤
	activateNewNodes(userId);

	return {
		success: true,
		cost,
		effects: getUpgradeEffects(upgradeId, level),
	};
}

function calculateUpgradeCost(upgrade, level) {
	return upgrade.basePrice * Math.pow(upgrade.priceMultiplier, level - 1);
}

function applyUpgradeEffects(userId, upgradeId, level) {
	const upgrade = upgradeTree.nodes[upgradeId];
	const effect = upgrade.effectPerLevel * level;

	switch (upgrade.category) {
		case 'production':
			userState.upgradeMultipliers.production += effect;
			break;
		case 'economy':
			userState.upgradeMultipliers.efficiency += effect;
			break;
		case 'special':
			applySpecialEffect(userId, upgradeId, effect);
			break;
	}
}
```

### 4. –°–∏—Å—Ç–µ–º–∞ —Å–æ–±—ã—Ç–∏–π

#### –¢–∏–ø—ã —Å–æ–±—ã—Ç–∏–π

**–°–ª—É—á–∞–π–Ω—ã–µ (RANDOM)**

-   –ó–∞–ø—É—Å–∫–∞—é—Ç—Å—è —Å–ª—É—á–∞–π–Ω–æ —Å –∑–∞–¥–∞–Ω–Ω–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é
-   –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: `{ chancePerHour: 0.1 }` - 10% –≤ —á–∞—Å

**–ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ (PERIODIC)**

-   –ó–∞–ø—É—Å–∫–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã
-   –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: `{ interval: '1h' }` - –∫–∞–∂–¥—ã–π —á–∞—Å

**–£—Å–ª–æ–≤–Ω—ã–µ (CONDITIONAL)**

-   –ó–∞–ø—É—Å–∫–∞—é—Ç—Å—è –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —É—Å–ª–æ–≤–∏–π
-   –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: `{ condition: { metric: 'chaosLevel', op: '>', value: 50 } }`

**–¶–µ–ø–æ—á–Ω—ã–µ (CHAINED)**

-   –ó–∞–ø—É—Å–∫–∞—é—Ç—Å—è –ø–æ—Å–ª–µ –¥—Ä—É–≥–∏—Ö —Å–æ–±—ã—Ç–∏–π
-   –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: `{ after: 'eventId' }`

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–±—ã—Ç–∏—è

```javascript
const gameEvent = {
	id: 'star_storm',
	name: 'Star Storm',
	description: {
		en: 'Increased star production for 1 hour',
		ru: '–£–≤–µ–ª–∏—á–µ–Ω–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –∑–≤–µ–∑–¥ –Ω–∞ 1 —á–∞—Å',
	},
	type: 'RANDOM',
	triggerConfig: {
		chancePerHour: 0.1,
		minInterval: 1800000, // 30 –º–∏–Ω—É—Ç –º–µ–∂–¥—É —Å–æ–±—ã—Ç–∏—è–º–∏
	},
	effect: {
		type: 'multiplier',
		target: 'production',
		value: 2.0,
		duration: 3600000, // 1 —á–∞—Å
		stackable: false,
	},
	conditions: {
		minStars: 100,
		maxActiveEvents: 3,
	},
};
```

#### –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π

```javascript
function checkAndTriggerEvents(userId) {
	const userState = getUserState(userId);
	const activeEvents = userState.activeEvents;
	const availableEvents = getAvailableEvents();

	availableEvents.forEach((event) => {
		if (shouldTriggerEvent(event, userState)) {
			triggerEvent(event, userId);
		}
	});

	// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
	updateActiveEvents(userId);

	// –†–∞—Å—á–µ—Ç –º–Ω–æ–∂–∏—Ç–µ–ª–µ–π
	calculateEventMultipliers(userId);
}

function shouldTriggerEvent(event, userState) {
	switch (event.type) {
		case 'RANDOM':
			return Math.random() < event.triggerConfig.chancePerHour / 3600;

		case 'PERIODIC':
			const lastTrigger = userState.eventCooldowns[event.id] || 0;
			return (
				Date.now() - lastTrigger >
				parseInterval(event.triggerConfig.interval)
			);

		case 'CONDITIONAL':
			return checkCondition(event.triggerConfig.condition, userState);

		default:
			return false;
	}
}

function triggerEvent(event, userId) {
	const userState = getUserState(userId);

	// –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –≤ –∞–∫—Ç–∏–≤–Ω—ã–µ
	userState.activeEvents.push({
		id: event.id,
		startTime: Date.now(),
		endTime: Date.now() + event.effect.duration,
		effect: event.effect,
	});

	// –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫—É–ª–¥–∞—É–Ω–∞
	userState.eventCooldowns[event.id] = Date.now();

	// –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤
	applyEventEffects(userId, event.effect);

	// –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
	loggerService.info('Event triggered', { userId, eventId: event.id });
}
```

### 5. –°–∏—Å—Ç–µ–º–∞ –∑–∞–¥–∞—á

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–¥–∞—á–∏

```javascript
const task = {
	id: 'first_steps',
	title: {
		en: 'First Steps',
		ru: '–ü–µ—Ä–≤—ã–µ —à–∞–≥–∏',
	},
	description: {
		en: 'Produce 100 stars',
		ru: '–ü—Ä–æ–∏–∑–≤–µ–¥–∏—Ç–µ 100 –∑–≤–µ–∑–¥',
	},
	reward: {
		stardust: 50,
		experience: 10,
	},
	condition: {
		type: 'production',
		target: 'totalStars',
		operator: '>=',
		value: 100,
		timeLimit: 86400000, // 24 —á–∞—Å–∞
	},
	icon: '‚≠ê',
	category: 'tutorial',
	weight: 1,
};
```

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á

```javascript
function checkTaskProgress(userId) {
	const userState = getUserState(userId);
	const availableTasks = getAvailableTasks();

	availableTasks.forEach((task) => {
		if (isTaskCompleted(task, userState)) {
			completeTask(userId, task.id);
		} else {
			updateTaskProgress(userId, task.id);
		}
	});
}

function isTaskCompleted(task, userState) {
	const condition = task.condition;
	const currentValue = getCurrentValue(condition.target, userState);

	switch (condition.operator) {
		case '>=':
			return currentValue >= condition.value;
		case '>':
			return currentValue > condition.value;
		case '==':
			return currentValue === condition.value;
		case '<':
			return currentValue < condition.value;
		case '<=':
			return currentValue <= condition.value;
		default:
			return false;
	}
}

function getCurrentValue(target, userState) {
	switch (target) {
		case 'totalStars':
			return userState.state.totalStars;
		case 'stardustCount':
			return userState.state.stardustCount;
		case 'ownedGalaxiesCount':
			return userState.state.ownedGalaxiesCount;
		case 'chaosLevel':
			return userState.chaosLevel;
		case 'stabilityLevel':
			return userState.stabilityLevel;
		default:
			return 0;
	}
}

function completeTask(userId, taskId) {
	const task = getTask(taskId);
	const userState = getUserState(userId);

	// –í—ã–¥–∞—á–∞ –Ω–∞–≥—Ä–∞–¥
	userState.state.stardustCount += task.reward.stardust;

	// –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ
	userState.completedTasks.push({
		id: taskId,
		completedAt: Date.now(),
	});

	// –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –∞–∫—Ç–∏–≤–Ω—ã—Ö
	userState.activeTasks = userState.activeTasks.filter((id) => id !== taskId);

	// –ê–∫—Ç–∏–≤–∞—Ü–∏—è –Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á
	activateNewTasks(userId);

	// –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
	loggerService.info('Task completed', {
		userId,
		taskId,
		rewards: task.reward,
	});
}
```

### 6. –°–∏—Å—Ç–µ–º–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –∏ —Ö–∞–æ—Å–∞

#### –ú–µ—Ö–∞–Ω–∏–∫–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏

```javascript
function calculateStability(userState) {
	let stability = 0.5; // –±–∞–∑–æ–≤–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å

	// –í–ª–∏—è–Ω–∏–µ –∞–ø–≥—Ä–µ–π–¥–æ–≤
	const upgradeStability = calculateUpgradeStability(userState);
	stability += upgradeStability;

	// –í–ª–∏—è–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π
	const eventStability = calculateEventStability(userState);
	stability += eventStability;

	// –í–ª–∏—è–Ω–∏–µ –≥–∞–ª–∞–∫—Ç–∏–∫
	const galaxyStability = calculateGalaxyStability(userState);
	stability += galaxyStability;

	// –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π
	return Math.max(0, Math.min(1, stability));
}

function calculateUpgradeStability(userState) {
	let stability = 0;

	Object.values(userState.userUpgrades).forEach((upgrade) => {
		if (upgrade.stability) {
			stability += upgrade.stability * upgrade.level;
		}
	});

	return stability;
}
```

#### –ú–µ—Ö–∞–Ω–∏–∫–∞ —Ö–∞–æ—Å–∞

```javascript
function calculateChaos(userState) {
	let chaos = 0.1; // –±–∞–∑–æ–≤–∞—è –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å

	// –í–ª–∏—è–Ω–∏–µ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö –∞–ø–≥—Ä–µ–π–¥–æ–≤
	const upgradeChaos = calculateUpgradeChaos(userState);
	chaos += upgradeChaos;

	// –í–ª–∏—è–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π
	const eventChaos = calculateEventChaos(userState);
	chaos += eventChaos;

	// –°–ª—É—á–∞–π–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã
	const randomChaos = Math.random() * 0.05;
	chaos += randomChaos;

	// –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π
	return Math.max(0, Math.min(1, chaos));
}
```

### 7. –°–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π

#### –¢–∏–ø—ã –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π

```javascript
const achievements = {
	first_galaxy: {
		id: 'first_galaxy',
		title: { en: 'First Galaxy', ru: '–ü–µ—Ä–≤–∞—è –≥–∞–ª–∞–∫—Ç–∏–∫–∞' },
		description: {
			en: 'Own your first galaxy',
			ru: '–í–ª–∞–¥–µ–π—Ç–µ —Å–≤–æ–µ–π –ø–µ—Ä–≤–æ–π –≥–∞–ª–∞–∫—Ç–∏–∫–æ–π',
		},
		condition: { type: 'count', target: 'ownedGalaxiesCount', value: 1 },
		reward: { stardust: 100, icon: 'üåå' },
	},
	star_collector: {
		id: 'star_collector',
		title: { en: 'Star Collector', ru: '–°–æ–±–∏—Ä–∞—Ç–µ–ª—å –∑–≤–µ–∑–¥' },
		description: { en: 'Collect 1000 stars', ru: '–°–æ–±–µ—Ä–∏—Ç–µ 1000 –∑–≤–µ–∑–¥' },
		condition: { type: 'production', target: 'totalStars', value: 1000 },
		reward: { stardust: 500, icon: '‚≠ê' },
	},
	upgrade_master: {
		id: 'upgrade_master',
		title: { en: 'Upgrade Master', ru: '–ú–∞—Å—Ç–µ—Ä –∞–ø–≥—Ä–µ–π–¥–æ–≤' },
		description: {
			en: 'Complete 10 upgrades',
			ru: '–ó–∞–≤–µ—Ä—à–∏—Ç–µ 10 –∞–ø–≥—Ä–µ–π–¥–æ–≤',
		},
		condition: { type: 'count', target: 'completedUpgrades', value: 10 },
		reward: { stardust: 1000, icon: '‚ö°' },
	},
};
```

### 8. –§–æ—Ä–º—É–ª—ã –∏ —Ä–∞—Å—á–µ—Ç—ã

#### –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ —Ä–µ—Å—É—Ä—Å–æ–≤

```javascript
// –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –∑–≤–µ–∑–¥
function calculateStarProduction(galaxies, multipliers, timeDelta) {
	let totalProduction = 0;

	galaxies.forEach((galaxy) => {
		if (!galaxy.active) return;

		const baseProduction = galaxy.starCurrent * 0.1; // 10% –æ—Ç —Ç–µ–∫—É—â–∏—Ö –∑–≤–µ–∑–¥
		const productionMultiplier = multipliers.production || 1.0;
		const efficiencyMultiplier = multipliers.efficiency || 1.0;
		const galaxyEfficiency = galaxy.galaxyProperties.efficiency || 1.0;

		const production =
			baseProduction *
			productionMultiplier *
			efficiencyMultiplier *
			galaxyEfficiency;
		totalProduction += production * (timeDelta / 1000); // –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ —Å–µ–∫—É–Ω–¥—ã
	});

	return totalProduction;
}

// –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–≤–µ–∑–¥–Ω–æ–π –ø—ã–ª–∏
function calculateStardustGain(baseReward, multipliers, bonuses) {
	const rewardMultiplier = multipliers.rewards || 1.0;
	const bonusMultiplier = bonuses.stardust || 1.0;

	return Math.floor(baseReward * rewardMultiplier * bonusMultiplier);
}
```

#### –°—Ç–æ–∏–º–æ—Å—Ç—å –∞–ø–≥—Ä–µ–π–¥–æ–≤

```javascript
function calculateUpgradeCost(upgrade, currentLevel, userMultipliers) {
	const baseCost = upgrade.basePrice;
	const levelMultiplier = Math.pow(upgrade.priceMultiplier, currentLevel);
	const costMultiplier = userMultipliers.cost || 1.0;

	return Math.floor(baseCost * levelMultiplier * costMultiplier);
}

function calculateGalaxyPrice(basePrice, size, features) {
	const sizeMultiplier = {
		small: 0.5,
		medium: 1.0,
		large: 2.0,
	};

	const featureMultiplier =
		Object.values(features).filter(Boolean).length * 0.2 + 1;

	return Math.floor(basePrice * sizeMultiplier[size] * featureMultiplier);
}
```

#### –í—Ä–µ–º—è –∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã

```javascript
function parseInterval(interval) {
	const units = {
		s: 1000,
		m: 60 * 1000,
		h: 60 * 60 * 1000,
		d: 24 * 60 * 60 * 1000,
	};

	const match = interval.match(/^(\d+)([smhd])$/);
	if (!match) return 0;

	const value = parseInt(match[1]);
	const unit = match[2];

	return value * units[unit];
}

function formatTime(ms) {
	const seconds = Math.floor(ms / 1000);
	const minutes = Math.floor(seconds / 60);
	const hours = Math.floor(minutes / 60);
	const days = Math.floor(hours / 24);

	if (days > 0) return `${days}d ${hours % 24}h`;
	if (hours > 0) return `${hours}h ${minutes % 60}m`;
	if (minutes > 0) return `${minutes}m ${seconds % 60}s`;
	return `${seconds}s`;
}
```

### 9. –ë–∞–ª–∞–Ω—Å –∏–≥—Ä—ã

#### –ü—Ä–æ–≥—Ä–µ—Å—Å–∏—è

```javascript
const progressionCurve = {
	// –°—Ç–æ–∏–º–æ—Å—Ç—å –≥–∞–ª–∞–∫—Ç–∏–∫ —Ä–∞—Å—Ç–µ—Ç —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ
	galaxyPrice: (count) => Math.floor(100 * Math.pow(1.5, count)),

	// –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –∑–≤–µ–∑–¥ —Ä–∞—Å—Ç–µ—Ç –ª–∏–Ω–µ–π–Ω–æ
	starProduction: (galaxies) =>
		galaxies.reduce((sum, g) => sum + g.starCurrent * 0.1, 0),

	// –°—Ç–æ–∏–º–æ—Å—Ç—å –∞–ø–≥—Ä–µ–π–¥–æ–≤ —Ä–∞—Å—Ç–µ—Ç —Å—Ç–µ–ø–µ–Ω–Ω–æ
	upgradePrice: (basePrice, level) =>
		Math.floor(basePrice * Math.pow(1.3, level - 1)),

	// –ù–∞–≥—Ä–∞–¥—ã –∑–∞ –∑–∞–¥–∞—á–∏ —Ä–∞—Å—Ç—É—Ç –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–∏
	taskReward: (difficulty) => Math.floor(50 * Math.log(difficulty + 1)),
};
```

#### –ú–Ω–æ–∂–∏—Ç–µ–ª–∏

```javascript
const multiplierCaps = {
	production: 10.0, // –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –º–Ω–æ–∂–∏—Ç–µ–ª—å –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞
	efficiency: 5.0, // –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –º–Ω–æ–∂–∏—Ç–µ–ª—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
	rewards: 3.0, // –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –º–Ω–æ–∂–∏—Ç–µ–ª—å –Ω–∞–≥—Ä–∞–¥
	cost: 0.5, // –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –º–Ω–æ–∂–∏—Ç–µ–ª—å —Å—Ç–æ–∏–º–æ—Å—Ç–∏
};

function applyMultiplierCap(multiplier, cap) {
	return Math.min(multiplier, cap);
}
```

---

–≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–ø–∏—Å—ã–≤–∞–µ—Ç –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –∏–≥—Ä–æ–≤—ã–µ –º–µ—Ö–∞–Ω–∏–∫–∏ Nebulahunt, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Ç–æ–≥–æ, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –∏–≥—Ä—ã –∏ –∫–∞–∫ –æ–Ω–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—Ç –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º.
